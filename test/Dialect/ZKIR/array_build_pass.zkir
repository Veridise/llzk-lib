// RUN: zkir-opt -split-input-file %s 2>&1 | FileCheck %s

func.func private @arr_constant_index() -> !zkir.array<3 x index> {
  %a = index.constant 45
  %b = index.constant 214
  %c = index.constant 2
  %r = zkir.new_array %a, %b, %c : !zkir.array<3 x index>
  return %r: !zkir.array<3 x index>
}
//CHECK-LABEL:  func.func private @arr_constant_index() -> !zkir.array<3 x index> {
//CHECK-NEXT:     %[[T1:[0-9a-zA-Z_\.]+]] = index.constant 45
//CHECK-NEXT:     %[[T2:[0-9a-zA-Z_\.]+]] = index.constant 214
//CHECK-NEXT:     %[[T3:[0-9a-zA-Z_\.]+]] = index.constant 2
//CHECK-NEXT:     %[[T4:[0-9a-zA-Z_\.]+]] = zkir.new_array %[[T1]], %[[T2]], %[[T3]] : <3 x index>
//CHECK-NEXT:     return %[[T4]] : !zkir.array<3 x index>
//CHECK-NEXT:   }
// -----

func.func private @arr_mix_index(%a: index, %b: index) -> !zkir.array<4 x index> {
  %c = index.constant 324
  %d = index.constant 999
  %r = zkir.new_array %a, %b, %c, %d: !zkir.array<4 x index>
  return %r: !zkir.array<4 x index>
}
//CHECK-LABEL:  func.func private @arr_mix_index
//CHECK-SAME:   (%[[A0:[0-9a-zA-Z_\.]+]]: index, %[[A1:[0-9a-zA-Z_\.]+]]: index) -> !zkir.array<4 x index> {
//CHECK-NEXT:     %[[T1:[0-9a-zA-Z_\.]+]] = index.constant 324
//CHECK-NEXT:     %[[T2:[0-9a-zA-Z_\.]+]] = index.constant 999
//CHECK-NEXT:     %[[T3:[0-9a-zA-Z_\.]+]] = zkir.new_array %[[A0]], %[[A1]], %[[T1]], %[[T2]] : <4 x index>
//CHECK-NEXT:     return %[[T3]] : !zkir.array<4 x index>
//CHECK-NEXT:   }
// -----

func.func private @arr_arr_mix_index(%a: !zkir.array<3 x index>) -> !zkir.array<2 x !zkir.array<3 x index>> {
  %c = index.constant 343245
  %d = index.constant 345
  %e = index.constant 2344
  %b = zkir.new_array %e, %c, %d: !zkir.array<3 x index>
  %r = zkir.new_array %a, %b: !zkir.array<2 x !zkir.array<3 x index>>
  return %r: !zkir.array<2 x !zkir.array<3 x index>>
}
//CHECK-LABEL:  func.func private @arr_arr_mix_index
//CHECK-SAME:   (%[[A0:[0-9a-zA-Z_\.]+]]: !zkir.array<3 x index>) -> !zkir.array<2 x !zkir.array<3 x index>> {
//CHECK-NEXT:     %[[T1:[0-9a-zA-Z_\.]+]] = index.constant 343245
//CHECK-NEXT:     %[[T2:[0-9a-zA-Z_\.]+]] = index.constant 345
//CHECK-NEXT:     %[[T3:[0-9a-zA-Z_\.]+]] = index.constant 2344
//CHECK-NEXT:     %[[T4:[0-9a-zA-Z_\.]+]] = zkir.new_array %[[T3]], %[[T1]], %[[T2]] : <3 x index>
//CHECK-NEXT:     %[[T5:[0-9a-zA-Z_\.]+]] = zkir.new_array %[[A0]], %[[T4]] : <2 x !zkir.array<3 x index>>
//CHECK-NEXT:     return %[[T5]] : !zkir.array<2 x !zkir.array<3 x index>>
//CHECK-NEXT:   }
// -----

func.func private @arr_constant_felt() -> !zkir.array<2 x !zkir.felt> {
  %a = zkir.felt.const 6744573456376
  %b = zkir.felt.const 381928390103509
  %r = zkir.new_array %a, %b : !zkir.array<2 x !zkir.felt>
  return %r: !zkir.array<2 x !zkir.felt>
}
//CHECK-LABEL:  func.func private @arr_constant_felt() -> !zkir.array<2 x !zkir.felt> {
//CHECK-NEXT:     %[[T1:[0-9a-zA-Z_\.]+]] = zkir.felt.const  6744573456376
//CHECK-NEXT:     %[[T2:[0-9a-zA-Z_\.]+]] = zkir.felt.const  381928390103509
//CHECK-NEXT:     %[[T3:[0-9a-zA-Z_\.]+]] = zkir.new_array %[[T1]], %[[T2]] : <2 x !zkir.felt>
//CHECK-NEXT:     return %[[T3]] : !zkir.array<2 x !zkir.felt>
//CHECK-NEXT:   }
// -----

func.func private @arr_params_felt(%a: !zkir.felt, %b: !zkir.felt, %c: !zkir.felt, %d: !zkir.felt) -> !zkir.array<4 x !zkir.felt> {
  %r = zkir.new_array %a, %b, %c, %d: !zkir.array<4 x !zkir.felt>
  return %r: !zkir.array<4 x !zkir.felt>
}
//CHECK-LABEL:  func.func private @arr_params_felt
//CHECK-SAME:   (%[[A0:[0-9a-zA-Z_\.]+]]: !zkir.felt, %[[A1:[0-9a-zA-Z_\.]+]]: !zkir.felt,
//CHECK-SAME:    %[[A2:[0-9a-zA-Z_\.]+]]: !zkir.felt, %[[A3:[0-9a-zA-Z_\.]+]]: !zkir.felt) -> !zkir.array<4 x !zkir.felt> {
//CHECK-NEXT:     %[[T1:[0-9a-zA-Z_\.]+]] = zkir.new_array %[[A0]], %[[A1]], %[[A2]], %[[A3]] : <4 x !zkir.felt>
//CHECK-NEXT:     return %[[T1]] : !zkir.array<4 x !zkir.felt>
//CHECK-NEXT:   }
// -----

func.func private @arr_arr_felt(%a: !zkir.array<4 x !zkir.felt>, %b: !zkir.array<4 x !zkir.felt>) -> !zkir.array<2 x !zkir.array<4 x !zkir.felt>> {
  %r = zkir.new_array %a, %b: !zkir.array<2 x !zkir.array<4 x !zkir.felt>>
  return %r: !zkir.array<2 x !zkir.array<4 x !zkir.felt>>
}
//CHECK-LABEL:  func.func private @arr_arr_felt
//CHECK-SAME:   (%[[A0:[0-9a-zA-Z_\.]+]]: !zkir.array<4 x !zkir.felt>, 
//CHECK-SAME:    %[[A1:[0-9a-zA-Z_\.]+]]: !zkir.array<4 x !zkir.felt>) -> !zkir.array<2 x !zkir.array<4 x !zkir.felt>> {
//CHECK-NEXT:     %[[T1:[0-9a-zA-Z_\.]+]] = zkir.new_array %[[A0]], %[[A1]] : <2 x !zkir.array<4 x !zkir.felt>>
//CHECK-NEXT:     return %[[T1]] : !zkir.array<2 x !zkir.array<4 x !zkir.felt>>
//CHECK-NEXT:   }
// -----
