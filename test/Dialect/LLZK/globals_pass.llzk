// RUN: llzk-opt -split-input-file %s | FileCheck %s

// TEST: uninitialized globals
module attributes {veridise.lang = "llzk"} {
  llzk.global @s : !llzk.string
  llzk.global @i : index
  llzk.global @b : i1
  llzk.global @f : !llzk.felt
  llzk.global @ax : !llzk.array<3 x !llzk.string>
  llzk.global @ab : !llzk.array<2,2 x i1>
  llzk.global @af : !llzk.array<6,5,3 x !llzk.felt>
  llzk.global @ai : !llzk.array<3,3 x index>
}
// CHECK-DAG: llzk.global @s : !llzk.string
// CHECK-DAG: llzk.global @i : index
// CHECK-DAG: llzk.global @b : i1
// CHECK-DAG: llzk.global @f : !llzk.felt
// CHECK-DAG: llzk.global @ax : !llzk.array<3 x !llzk.string>
// CHECK-DAG: llzk.global @ab : !llzk.array<2,2 x i1>
// CHECK-DAG: llzk.global @af : !llzk.array<6,5,3 x !llzk.felt>
// CHECK-DAG: llzk.global @ai : !llzk.array<3,3 x index>
// -----

// TEST: initialized globals
module attributes {veridise.lang = "llzk"} {
  llzk.global const @s : !llzk.string = "Hello World!"
  llzk.global @i : index = 1

  llzk.global const @bf : i1 = false
  llzk.global const @t : i1 = true
  llzk.global @b0 : i1 = 0
  llzk.global const @b1 : i1 = 1

  llzk.global @f : !llzk.felt = 35

  llzk.global @a1i : !llzk.array<1 x index> = [2]
  llzk.global @a2s : !llzk.array<2 x !llzk.string> = ["hello", "world"]
  llzk.global @a4b : !llzk.array<2,2 x i1> = [0,1,1,0]
  llzk.global @a4f : !llzk.array<2,1,1,2 x !llzk.felt> = [6, 12134, 45523, 15623]
}
// CHECK-DAG: llzk.global const @s : !llzk.string = "Hello World!"
// CHECK-DAG: llzk.global @i : index = 1
// CHECK-DAG: llzk.global const @bf : i1 = false
// CHECK-DAG: llzk.global const @t : i1 = true
// CHECK-DAG: llzk.global @b0 : i1 = false
// CHECK-DAG: llzk.global const @b1 : i1 = true
// CHECK-DAG: llzk.global @f : !llzk.felt = 35
// CHECK-DAG: llzk.global @a1i : !llzk.array<1 x index> = [2]
// CHECK-DAG: llzk.global @a2s : !llzk.array<2 x !llzk.string> = ["hello", "world"]
// CHECK-DAG: llzk.global @a4b : !llzk.array<2,2 x i1> = [0, 1, 1, 0]
// CHECK-DAG: llzk.global @a4f : !llzk.array<2,1,1,2 x !llzk.felt> = [6, 12134, 45523, 15623]
// -----

// TEST: GlobalReadOp
module attributes {veridise.lang = "llzk"} {
  llzk.global const @g : !llzk.string = "Hello"
  llzk.func @test() -> !llzk.string {
    %t = llzk.readg @g : !llzk.string
    return %t : !llzk.string
  }
}
// CHECK-LABEL: llzk.global const @g : !llzk.string = "Hello"
// CHECK-LABEL: llzk.func @test() -> !llzk.string {
// CHECK-NEXT:    %[[V0:[0-9a-zA-Z_\.]+]] = readg @g : !llzk.string
// CHECK-NEXT:    return %[[V0]] : !llzk.string
// CHECK-NEXT:  }
// -----

// TEST: GlobalWriteOp
module attributes {veridise.lang = "llzk"} {
  llzk.global @g : !llzk.felt = 125
  llzk.func @test() {
    %c = constfelt 99999
    llzk.writeg @g = %c : !llzk.felt
    return
  }
}
// CHECK-LABEL: llzk.global @g : !llzk.felt = 125
// CHECK-LABEL: llzk.func @test() {
// CHECK-NEXT:    %[[V1:[0-9a-zA-Z_\.]+]] = constfelt 99999
// CHECK-NEXT:    writeg @g = %[[V1]] : !llzk.felt
// CHECK-NEXT:    return
// CHECK-NEXT:  }
